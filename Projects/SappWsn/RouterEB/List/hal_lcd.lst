###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         18/May/2013  01:29:27 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Texas Instruments\ZStack-CC2530-IOT\Components\ #
#                          hal\target\CC2530EB\hal_lcd.c                      #
#    Command line       =  -f "C:\Texas Instruments\ZStack-CC2530-IOT\Project #
#                          s\SappWsn\..\zstack\Tools\CC2530DB\f8wRouter.cfg"  #
#                          (-DCPU32MHZ -DROOT=__near_func                     #
#                          -DMAC_CFG_APP_PENDING_QUEUE=TRUE                   #
#                          -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8         #
#                          -DMAC_CFG_RX_MAX=5 -DRTR_NWK) -f "C:\Texas         #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          zstack\Tools\CC2530DB\f8wConfig.cfg" (-DZIGBEEPRO  #
#                          -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR       #
#                          -DDEFAULT_CHANLIST=0x02000000                      #
#                          -DZDAPP_CONFIG_PAN_ID=31 -DNWK_START_DELAY=100     #
#                          -DEXTENDED_JOINING_RANDOM_MASK=0x007F              #
#                          -DBEACON_REQUEST_DELAY=100                         #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 "C:\Texas                   #
#                          Instruments\ZStack-CC2530-IOT\Components\hal\targe #
#                          t\CC2530EB\hal_lcd.c" -D ZTOOL_P1 -D MT_TASK -D    #
#                          MT_SYS_FUNC -D MT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG  #
#                          -lC "C:\Texas Instruments\ZStack-CC2530-IOT\Projec #
#                          ts\SappWsn\RouterEB\List\" -lA "C:\Texas           #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\Rou #
#                          terEB\List\" --diag_suppress Pe001,Pa010 -o        #
#                          "C:\Texas Instruments\ZStack-CC2530-IOT\Projects\S #
#                          appWsn\RouterEB\Obj\" -e --no_code_motion --debug  #
#                          --core=plain --dptr=16,1 --data_model=large        #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\"   #
#                          -I "C:\Texas Instruments\ZStack-CC2530-IOT\Project #
#                          s\SappWsn\Source\" -I "C:\Texas                    #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          zstack\ZMain\TI2530DB\" -I "C:\Texas               #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\hal\include\" -I "C:\Texas           #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\hal\target\CC2530EB\" -I "C:\Texas   #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\mac\include\" -I "C:\Texas           #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\mac\high_level\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\mac\low_level\srf04\" -I "C:\Texas   #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\mac\low_level\srf04\single_chip\"    #
#                          -I "C:\Texas Instruments\ZStack-CC2530-IOT\Project #
#                          s\SappWsn\..\..\Components\mt\" -I "C:\Texas       #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\osal\include\" -I "C:\Texas          #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\services\saddr\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\services\sdata\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\stack\af\" -I "C:\Texas              #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\stack\nwk\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\stack\sapi\" -I "C:\Texas            #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\stack\sec\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\stack\sys\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\stack\zdo\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\zmac\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-IOT\Projects\SappWsn\..\ #
#                          ..\Components\zmac\f8w\" -Ohz --require_prototypes #
#    List file          =  C:\Texas Instruments\ZStack-CC2530-IOT\Projects\Sa #
#                          ppWsn\RouterEB\List\hal_lcd.lst                    #
#    Object file        =  C:\Texas Instruments\ZStack-CC2530-IOT\Projects\Sa #
#                          ppWsn\RouterEB\Obj\hal_lcd.r51                     #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-CC2530-IOT\Components\hal\target\CC2530EB\hal_lcd.c
      1          /**************************************************************************************************
      2            Filename:       hal_lcd.c
      3            Revised:        $Date: 2009-03-12 16:25:22 -0700 (Thu, 12 Mar 2009) $
      4            Revision:       $Revision: 19404 $
      5          
      6            Description:    This file contains the interface to the HAL LCD Service.
      7          
      8          
      9            Copyright 2007 - 2009 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /**************************************************************************************************
     41           *                                           INCLUDES
     42           **************************************************************************************************/
     43          #include "hal_types.h"
     44          #include "hal_lcd.h"
     45          #include "OSAL.h"
     46          #include "OnBoard.h"
     47          #include "hal_assert.h"
     48          #include "lcd_dis.h"
     49          #include "hal_led.h"
     50          #define HAL_LCD TRUE
     51          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
     52            #include "DebugTrace.h"
     53          #endif
     54          
     55          /**************************************************************************************************
     56           *                                          CONSTANTS
     57           **************************************************************************************************/
     58          /*
     59            LCD pins
     60          
     61            //control
     62            P0.0 - LCD_MODE
     63            P1.1 - LCD_FLASH_RESET
     64            P1.2 - LCD_CS
     65          
     66            //spi
     67            P1.5 - CLK
     68            P1.6 - MOSI
     69            P1.7 - MISO
     70          */
     71          
     72          /* LCD Control lines */
     73          #define HAL_LCD_MODE_PORT 0
     74          #define HAL_LCD_MODE_PIN  0
     75          
     76          #define HAL_LCD_RESET_PORT 1
     77          #define HAL_LCD_RESET_PIN  1
     78          
     79          #define HAL_LCD_CS_PORT 1
     80          #define HAL_LCD_CS_PIN  2
     81          
     82          /* LCD SPI lines */
     83          #define HAL_LCD_CLK_PORT 1
     84          #define HAL_LCD_CLK_PIN  5
     85          
     86          #define HAL_LCD_MOSI_PORT 1
     87          #define HAL_LCD_MOSI_PIN  6
     88          
     89          #define HAL_LCD_MISO_PORT 1
     90          #define HAL_LCD_MISO_PIN  7
     91          
     92          /* SPI settings */
     93          #define HAL_SPI_CLOCK_POL_LO       0x00
     94          #define HAL_SPI_CLOCK_PHA_0        0x00
     95          #define HAL_SPI_TRANSFER_MSB_FIRST 0x20
     96          
     97          /* LCD lines */
     98          #define LCD_MAX_LINE_COUNT              3
     99          #define LCD_MAX_LINE_LENGTH             16
    100          #define LCD_MAX_BUF                     25
    101          
    102          /* Defines for HW LCD */
    103          
    104          /* Set power save mode */
    105          #define OSC_OFF                         0x00
    106          #define OSC_ON                          0x01
    107          #define POWER_SAVE_OFF                  0x00
    108          #define POWER_SAVE_ON                   0x02
    109          #define SET_POWER_SAVE_MODE(options)    HalLcd_HW_Control(0x0C | (options))
    110          
    111          /* Function Set */
    112          #define CGROM                           0x00
    113          #define CGRAM                           0x01
    114          #define COM_FORWARD                     0x00
    115          #define COM_BACKWARD                    0x02
    116          #define TWO_LINE                        0x00
    117          #define THREE_LINE                      0x04
    118          #define FUNCTION_SET(options)           HalLcd_HW_Control(0x10 | (options))
    119          
    120          /* Set Display Start Line */
    121          #define SET_DISPLAY_START_LINE(line)    HalLcd_HW_Control(0x18 | (line))
    122          
    123          /* Bias control */
    124          #define BIAS_1_5                        0x00
    125          #define BIAS_1_4                        0x01
    126          #define SET_BIAS_CTRL(bias)             HalLcd_HW_Control(0x1C | (bias))
    127          
    128          /* Power control */
    129          #define VOLTAGE_DIVIDER_OFF             0x00
    130          #define VOLTAGE_DIVIDER_ON              0x01
    131          #define CONVERTER_AND_REG_OFF           0x00
    132          #define CONVERTER_AND_REG_ON            0x04
    133          #define SET_POWER_CTRL(options)         HalLcd_HW_Control(0x20 | (options))
    134          
    135          // Set display control
    136          #define DISPLAY_CTRL_ON                 0x01
    137          #define DISPLAY_CTRL_OFF                0x00
    138          #define DISPLAY_CTRL_BLINK_ON           0x02
    139          #define DISPLAY_CTRL_BLINK_OFF          0x00
    140          #define DISPLAY_CTRL_CURSOR_ON          0x04
    141          #define DISPLAY_CTRL_CURSOR_OFF         0x00
    142          #define SET_DISPLAY_CTRL(options)       HalLcd_HW_Control(0x28 | (options))
    143          
    144          /* Set DD/ CGRAM address */
    145          #define SET_DDRAM_ADDR(charIndex)       HalLcd_HW_Control(0x80 | (charIndex))
    146          #define SET_GCRAM_CHAR(specIndex)       HalLcd_HW_Control(0xC0 | (specIndex))
    147          
    148          /* Set ICONRAM address */
    149          #define CONTRAST_CTRL_REGISTER          0x10
    150          #define SET_ICONRAM_ADDR(addr)          HalLcd_HW_Control(0x40 | (addr))
    151          
    152          /* Set double height */
    153          #define LINE_1_AND_2                    0x01
    154          #define LINE_2_AND_3                    0x02
    155          #define NORMAL_DISPLAY                  0x00
    156          #define SET_DOUBLE_HEIGHT(options)      HalLcd_HW_Control(0x08 | (options))
    157          
    158          /**************************************************************************************************
    159           *                                           MACROS
    160           **************************************************************************************************/
    161          
    162          #define HAL_IO_SET(port, pin, val)        HAL_IO_SET_PREP(port, pin, val)
    163          #define HAL_IO_SET_PREP(port, pin, val)   st( P##port##_##pin## = val; )
    164          
    165          #define HAL_CONFIG_IO_OUTPUT(port, pin, val)      HAL_CONFIG_IO_OUTPUT_PREP(port, pin, val)
    166          #define HAL_CONFIG_IO_OUTPUT_PREP(port, pin, val) st( P##port##SEL &= ~BV(pin); \
    167                                                                P##port##_##pin## = val; \
    168                                                                P##port##DIR |= BV(pin); )
    169          
    170          #define HAL_CONFIG_IO_PERIPHERAL(port, pin)      HAL_CONFIG_IO_PERIPHERAL_PREP(port, pin)
    171          #define HAL_CONFIG_IO_PERIPHERAL_PREP(port, pin) st( P##port##SEL |= BV(pin); )
    172          
    173          
    174          
    175          /* SPI interface control */
    176          #define LCD_SPI_BEGIN()     HAL_IO_SET(HAL_LCD_CS_PORT,  HAL_LCD_CS_PIN,  0); /* chip select */
    177          #define LCD_SPI_END()                                                         \
    178          {                                                                             \
    179            asm("NOP");                                                                 \
    180            asm("NOP");                                                                 \
    181            asm("NOP");                                                                 \
    182            asm("NOP");                                                                 \
    183            HAL_IO_SET(HAL_LCD_CS_PORT,  HAL_LCD_CS_PIN,  1); /* chip select */         \
    184          }
    185          /* clear the received and transmit byte status, write tx data to buffer, wait till transmit done */
    186          #define LCD_SPI_TX(x)                   { U1CSR &= ~(BV(2) | BV(1)); U1DBUF = x; while( !(U1CSR & BV(1)) ); }
    187          #define LCD_SPI_WAIT_RXRDY()            { while(!(U1CSR & BV(1))); }
    188          
    189          
    190          /* Control macros */
    191          #define LCD_DO_WRITE()        HAL_IO_SET(HAL_LCD_MODE_PORT,  HAL_LCD_MODE_PIN,  1);
    192          #define LCD_DO_CONTROL()      HAL_IO_SET(HAL_LCD_MODE_PORT,  HAL_LCD_MODE_PIN,  0);
    193          
    194          #define LCD_ACTIVATE_RESET()  HAL_IO_SET(HAL_LCD_RESET_PORT, HAL_LCD_RESET_PIN, 0);
    195          #define LCD_RELEASE_RESET()   HAL_IO_SET(HAL_LCD_RESET_PORT, HAL_LCD_RESET_PIN, 1);
    196          
    197          
    198          /**************************************************************************************************
    199           *                                       GLOBAL VARIABLES
    200           **************************************************************************************************/

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    201          uint8 *Lcd_Line1;
   \                     Lcd_Line1:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    202          
    203          /**************************************************************************************************
    204           *                                       FUNCTIONS - API
    205           **************************************************************************************************/
    206          #if (HAL_LCD == TRUE)
    207          void HalLcd_HW_Init(void);
    208          void HalLcd_HW_WaitUs(uint16 i);
    209          void HalLcd_HW_Clear(void);
    210          void HalLcd_HW_ClearAllSpecChars(void);
    211          void HalLcd_HW_Control(uint8 cmd);
    212          void HalLcd_HW_Write(uint8 data);
    213          void HalLcd_HW_SetContrast(uint8 value);
    214          void HalLcd_HW_WriteChar(uint8 line, uint8 col, char text);
    215          void HalLcd_HW_WriteLine(uint8 line, const char *pText);
    216          #endif //LCD
    217          
    218          /**************************************************************************************************
    219           * @fn      HalLcdInit
    220           *
    221           * @brief   Initilize LCD Service
    222           *
    223           * @param   init - pointer to void that contains the initialized value
    224           *
    225           * @return  None
    226           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    227          void HalLcdInit(void)
   \                     HalLcdInit:
    228          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    229            Lcd_Line1 = NULL;
   \   000004   90....       MOV     DPTR,#Lcd_Line1
   \   000007   E4           CLR     A
   \   000008   F0           MOVX    @DPTR,A
   \   000009   A3           INC     DPTR
   \   00000A   F0           MOVX    @DPTR,A
    230          #if (HAL_LCD == TRUE)
    231            HalLcd_HW_Init();
   \   00000B                ; Setup parameters for call to function HalLcd_HW_Init
   \   00000B   12....       LCALL   ??HalLcd_HW_Init?relay
    232          #endif
    233          }
   \   00000E   D083         POP     DPH
   \   000010   D082         POP     DPL
   \   000012   02....       LJMP    ?BRET
    234          
    235          /*************************************************************************************************
    236           *                    LCD EMULATION FUNCTIONS
    237           *
    238           * Some evaluation boards are equipped with Liquid Crystal Displays
    239           * (LCD) which may be used to display diagnostic information. These
    240           * functions provide LCD emulation, sending the diagnostic strings
    241           * to Z-Tool via the RS232 serial port. These functions are enabled
    242           * when the "LCD_SUPPORTED" compiler flag is placed in the makefile.
    243           *
    244           * Most applications update both lines (1 and 2) of the LCD whenever
    245           * text is posted to the device. This emulator assumes that line 1 is
    246           * updated first (saved locally) and the formatting and send operation
    247           * is triggered by receipt of line 2. Nothing will be transmitted if
    248           * only line 1 is updated.
    249           *
    250           *************************************************************************************************/
    251          
    252          
    253          /**************************************************************************************************
    254           * @fn      HalLcdWriteString
    255           *
    256           * @brief   Write a string to the LCD
    257           *
    258           * @param   str    - pointer to the string that will be displayed
    259           *          option - display options
    260           *
    261           * @return  None
    262           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    263          void HalLcdWriteString ( char *str, uint8 option)
   \                     HalLcdWriteString:
    264          {
   \   000000   74EF         MOV     A,#-0x11
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 17
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   \   000009   89..         MOV     ?V0 + 8,R1
    265          #if (HAL_LCD == TRUE)
    266          
    267            uint8 strLen = 0;
    268            uint8 totalLen = 0;
    269            uint8 *buf;
    270            uint8 tmpLen;
    271            
    272            strLen = (uint8)osal_strlen( (char*)str );
   \   00000B                ; Setup parameters for call to function osal_strlen
   \   00000B   12....       LCALL   ??osal_strlen?relay
   \   00000E   EA           MOV     A,R2
   \   00000F   F5..         MOV     ?V0 + 7,A
    273          
    274            /* Check boundries */
    275            if ( strLen > HAL_LCD_MAX_CHARS )
   \   000011   C3           CLR     C
   \   000012   9411         SUBB    A,#0x11
   \   000014   4003         JC      ??HalLcdWriteString_0
    276              strLen = HAL_LCD_MAX_CHARS;
   \   000016   75..10       MOV     ?V0 + 7,#0x10
    277          
    278            if ( option == HAL_LCD_LINE_1 )
   \                     ??HalLcdWriteString_0:
   \   000019   7401         MOV     A,#0x1
   \   00001B   65..         XRL     A,?V0 + 8
   \   00001D   7038         JNZ     ??HalLcdWriteString_1
    279            {
    280              /* Line 1 gets saved for later */
    281              osal_memcpy( Lcd_Line1, str, strLen );
   \   00001F                ; Setup parameters for call to function osal_memcpy
   \   00001F   85....       MOV     ?V0 + 4,?V0 + 0
   \   000022   85....       MOV     ?V0 + 5,?V0 + 1
   \   000025   75..00       MOV     ?V0 + 6,#0x0
   \   000028   78..         MOV     R0,#?V0 + 4
   \   00002A   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00002D   85....       MOV     ?V0 + 2,?V0 + 7
   \   000030   AC..         MOV     R4,?V0 + 2
   \   000032   7D00         MOV     R5,#0x0
   \   000034   90....       MOV     DPTR,#Lcd_Line1
   \   000037   E0           MOVX    A,@DPTR
   \   000038   FA           MOV     R2,A
   \   000039   A3           INC     DPTR
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   FB           MOV     R3,A
   \   00003C   12....       LCALL   ??Subroutine8_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   00003F   12....       LCALL   ?DEALLOC_XSTACK8
    282              Lcd_Line1[strLen] = '\0';
   \   000042   A8..         MOV     R0,?V0 + 7
   \   000044   90....       MOV     DPTR,#Lcd_Line1
   \   000047   E0           MOVX    A,@DPTR
   \   000048   28           ADD     A,R0
   \   000049   FA           MOV     R2,A
   \   00004A   A3           INC     DPTR
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   3400         ADDC    A,#0x0
   \   00004E   8A82         MOV     DPL,R2
   \   000050   F583         MOV     DPH,A
   \   000052   E4           CLR     A
   \   000053   F0           MOVX    @DPTR,A
   \   000054   02....       LJMP    ??HalLcdWriteString_2 & 0xFFFF
    283            }
    284            else
    285            {
    286              /* Line 2 triggers action */
    287              tmpLen = (uint8)osal_strlen( (char*)Lcd_Line1 );
   \                     ??HalLcdWriteString_1:
   \   000057                ; Setup parameters for call to function osal_strlen
   \   000057   90....       MOV     DPTR,#Lcd_Line1
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   FA           MOV     R2,A
   \   00005C   A3           INC     DPTR
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   FB           MOV     R3,A
   \   00005F   12....       LCALL   ?Subroutine5 & 0xFFFF
    288              totalLen =  tmpLen + 1 + strLen + 1;
    289              buf = osal_mem_alloc( totalLen );
   \                     ??CrossCallReturnLabel_2:
   \   000062                ; Setup parameters for call to function osal_mem_alloc
   \   000062   25..         ADD     A,?V0 + 7
   \   000064   2402         ADD     A,#0x2
   \   000066   FA           MOV     R2,A
   \   000067   7B00         MOV     R3,#0x0
   \   000069   12....       LCALL   ??osal_mem_alloc?relay
   \   00006C   8A..         MOV     ?V0 + 4,R2
   \   00006E   8B..         MOV     ?V0 + 5,R3
   \   000070   AE..         MOV     R6,?V0 + 4
   \   000072   AF..         MOV     R7,?V0 + 5
    290              if ( buf != NULL )
   \   000074   EE           MOV     A,R6
   \   000075   4F           ORL     A,R7
   \   000076   606B         JZ      ??HalLcdWriteString_2
    291              {
    292                /* Concatenate strings */
    293                osal_memcpy( buf, Lcd_Line1, tmpLen );
   \   000078                ; Setup parameters for call to function osal_memcpy
   \   000078   90....       MOV     DPTR,#Lcd_Line1
   \   00007B   E0           MOVX    A,@DPTR
   \   00007C   F5..         MOV     ?V0 + 4,A
   \   00007E   A3           INC     DPTR
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   F5..         MOV     ?V0 + 5,A
   \   000082   75..00       MOV     ?V0 + 6,#0x0
   \   000085   78..         MOV     R0,#?V0 + 4
   \   000087   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00008A   85....       MOV     ?V0 + 4,?V0 + 2
   \   00008D   AC..         MOV     R4,?V0 + 4
   \   00008F   7D00         MOV     R5,#0x0
   \   000091   12....       LCALL   ??Subroutine8_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_14:
   \   000094   12....       LCALL   ?DEALLOC_XSTACK8
    294                buf[tmpLen++] = ' ';
   \   000097   EE           MOV     A,R6
   \   000098   25..         ADD     A,?V0 + 4
   \   00009A   F582         MOV     DPL,A
   \   00009C   EF           MOV     A,R7
   \   00009D   12....       LCALL   ??Subroutine10_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   0000A0   05..         INC     ?V0 + 2
    295                osal_memcpy( &buf[tmpLen], str, strLen );
   \   0000A2                ; Setup parameters for call to function osal_memcpy
   \   0000A2   85....       MOV     ?V0 + 4,?V0 + 0
   \   0000A5   85....       MOV     ?V0 + 5,?V0 + 1
   \   0000A8   78..         MOV     R0,#?V0 + 4
   \   0000AA   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000AD   85....       MOV     ?V0 + 4,?V0 + 7
   \   0000B0   AC..         MOV     R4,?V0 + 4
   \   0000B2   7D00         MOV     R5,#0x0
   \   0000B4   EE           MOV     A,R6
   \   0000B5   25..         ADD     A,?V0 + 2
   \   0000B7   FA           MOV     R2,A
   \   0000B8   EF           MOV     A,R7
   \   0000B9   3400         ADDC    A,#0x0
   \   0000BB   FB           MOV     R3,A
   \   0000BC   12....       LCALL   ??Subroutine8_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   0000BF   12....       LCALL   ?DEALLOC_XSTACK8
    296                buf[tmpLen+strLen] = '\0';
   \   0000C2   E5..         MOV     A,?V0 + 2
   \   0000C4   25..         ADD     A,?V0 + 4
   \   0000C6   F8           MOV     R0,A
   \   0000C7   E4           CLR     A
   \   0000C8   3400         ADDC    A,#0x0
   \   0000CA   F9           MOV     R1,A
   \   0000CB   EE           MOV     A,R6
   \   0000CC   28           ADD     A,R0
   \   0000CD   F582         MOV     DPL,A
   \   0000CF   EF           MOV     A,R7
   \   0000D0   39           ADDC    A,R1
   \   0000D1   F583         MOV     DPH,A
   \   0000D3   E4           CLR     A
   \   0000D4   F0           MOVX    @DPTR,A
    297          
    298                /* Send it out */
    299          #if defined (ZTOOL_P1) || defined (ZTOOL_P2)
    300          
    301          #if defined(SERIAL_DEBUG_SUPPORTED)
    302                debug_str( (uint8*)buf );
   \   0000D5                ; Setup parameters for call to function debug_str
   \   0000D5   EE           MOV     A,R6
   \   0000D6   FA           MOV     R2,A
   \   0000D7   EF           MOV     A,R7
   \   0000D8   FB           MOV     R3,A
   \   0000D9   12....       LCALL   ??debug_str?relay
    303          #endif //LCD_SUPPORTED
    304          
    305          #endif //ZTOOL_P1
    306          
    307                /* Free mem */
    308                osal_mem_free( buf );
   \   0000DC                ; Setup parameters for call to function osal_mem_free
   \   0000DC   EE           MOV     A,R6
   \   0000DD   FA           MOV     R2,A
   \   0000DE   EF           MOV     A,R7
   \   0000DF   FB           MOV     R3,A
   \   0000E0   12....       LCALL   ??osal_mem_free?relay
    309              }
    310            }
    311          
    312            /* Display the string */
    313            HalLcd_HW_WriteLine (option, str);
   \                     ??HalLcdWriteString_2:
   \   0000E3                ; Setup parameters for call to function HalLcd_HW_WriteLine
   \   0000E3   AA..         MOV     R2,?V0 + 0
   \   0000E5   AB..         MOV     R3,?V0 + 1
   \   0000E7   A9..         MOV     R1,?V0 + 8
   \   0000E9   12....       LCALL   ??HalLcd_HW_WriteLine?relay
    314          
    315          #endif //HAL_LCD
    316          
    317          }
   \   0000EC   7F09         MOV     R7,#0x9
   \   0000EE   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   12....       LCALL   ??osal_strlen?relay
   \   000003   EA           MOV     A,R2
   \   000004   F5..         MOV     ?V0 + 2,A
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine8_0:
   \   000000   12....       LCALL   ??osal_memcpy?relay
   \   000003   7403         MOV     A,#0x3
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine10_0:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F583         MOV     DPH,A
   \   000004   7420         MOV     A,#0x20
   \   000006   F0           MOVX    @DPTR,A
   \   000007   22           RET
    318          
    319          /**************************************************************************************************
    320           * @fn      HalLcdWriteValue
    321           *
    322           * @brief   Write a value to the LCD
    323           *
    324           * @param   value  - value that will be displayed
    325           *          radix  - 8, 10, 16
    326           *          option - display options
    327           *
    328           * @return  None
    329           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    330          void HalLcdWriteValue ( uint32 value, const uint8 radix, uint8 option)
   \                     HalLcdWriteValue:
    331          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 25
   \   000005   74E7         MOV     A,#-0x19
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7429         MOV     A,#0x29
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   FE           MOV     R6,A
    332          #if (HAL_LCD == TRUE)
    333            uint8 buf[LCD_MAX_BUF];
    334          
    335            _ltoa( value, &buf[0], radix );
   \   000011                ; Setup parameters for call to function _ltoa
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   8582..       MOV     ?V0 + 0,DPL
   \   00001A   8583..       MOV     ?V0 + 1,DPH
   \   00001D   78..         MOV     R0,#?V0 + 0
   \   00001F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000022   12....       LCALL   ??Subroutine7_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   000025   12....       LCALL   ?DEALLOC_XSTACK8
    336            HalLcdWriteString( (char*)buf, option );
   \   000028                ; Setup parameters for call to function HalLcdWriteString
   \   000028   EE           MOV     A,R6
   \   000029   F9           MOV     R1,A
   \   00002A   85..82       MOV     DPL,?XSP + 0
   \   00002D   85..83       MOV     DPH,?XSP + 1
   \   000030   AA82         MOV     R2,DPL
   \   000032   AB83         MOV     R3,DPH
   \   000034   12....       LCALL   ??HalLcdWriteString?relay
    337          #endif
    338          }
   \   000037   7419         MOV     A,#0x19
   \   000039   12....       LCALL   ?DEALLOC_XSTACK8
   \   00003C   7F08         MOV     R7,#0x8
   \   00003E   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine7_0:
   \   000000   12....       LCALL   ??_ltoa?relay
   \   000003   7402         MOV     A,#0x2
   \   000005   22           RET
    339          
    340          /**************************************************************************************************
    341           * @fn      HalLcdWriteScreen
    342           *
    343           * @brief   Write a value to the LCD
    344           *
    345           * @param   line1  - string that will be displayed on line 1
    346           *          line2  - string that will be displayed on line 2
    347           *
    348           * @return  None
    349           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    350          void HalLcdWriteScreen( char *line1, char *line2 )
   \                     HalLcdWriteScreen:
    351          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EC           MOV     A,R4
   \   000006   FE           MOV     R6,A
   \   000007   ED           MOV     A,R5
   \   000008   FF           MOV     R7,A
    352          #if (HAL_LCD == TRUE)
    353            HalLcdWriteString( line1, 1 );
   \   000009                ; Setup parameters for call to function HalLcdWriteString
   \   000009   7901         MOV     R1,#0x1
   \   00000B   12....       LCALL   ??HalLcdWriteString?relay
    354            HalLcdWriteString( line2, 2 );
   \   00000E                ; Setup parameters for call to function HalLcdWriteString
   \   00000E   7902         MOV     R1,#0x2
   \   000010   EE           MOV     A,R6
   \   000011   FA           MOV     R2,A
   \   000012   EF           MOV     A,R7
   \   000013   FB           MOV     R3,A
   \   000014   12....       LCALL   ??HalLcdWriteString?relay
    355          #endif
    356          }
   \   000017                REQUIRE ?Subroutine0
   \   000017                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    357          
    358          /**************************************************************************************************
    359           * @fn      HalLcdWriteStringValue
    360           *
    361           * @brief   Write a string followed by a value to the LCD
    362           *
    363           * @param   title  - Title that will be displayed before the value
    364           *          value  - value
    365           *          format - redix
    366           *          line   - line number
    367           *
    368           * @return  None
    369           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    370          void HalLcdWriteStringValue( char *title, uint16 value, uint8 format, uint8 line )
   \                     HalLcdWriteStringValue:
    371          {
   \   000000   74EE         MOV     A,#-0x12
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 18
   \   000005                ; Auto size: 25
   \   000005   74E7         MOV     A,#-0x19
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   \   00000E   8C..         MOV     ?V0 + 8,R4
   \   000010   8D..         MOV     ?V0 + 9,R5
   \   000012   89..         MOV     ?V0 + 0,R1
   \   000014   742B         MOV     A,#0x2b
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 1,A
    372          #if (HAL_LCD == TRUE)
    373            uint8 tmpLen;
    374            uint8 buf[LCD_MAX_BUF];
    375            uint32 err;
    376          
    377            tmpLen = (uint8)osal_strlen( (char*)title );
   \   00001C                ; Setup parameters for call to function osal_strlen
   \   00001C   12....       LCALL   ?Subroutine5 & 0xFFFF
    378            osal_memcpy( buf, title, tmpLen );
   \                     ??CrossCallReturnLabel_3:
   \   00001F                ; Setup parameters for call to function osal_memcpy
   \   00001F   8E..         MOV     ?V0 + 4,R6
   \   000021   8F..         MOV     ?V0 + 5,R7
   \   000023   75..00       MOV     ?V0 + 6,#0x0
   \   000026   78..         MOV     R0,#?V0 + 4
   \   000028   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00002B   8A..         MOV     ?V0 + 4,R2
   \   00002D   AC..         MOV     R4,?V0 + 4
   \   00002F   7D00         MOV     R5,#0x0
   \   000031   7403         MOV     A,#0x3
   \   000033   12....       LCALL   ?XSTACK_DISP0_8
   \   000036   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_10:
   \   000039   12....       LCALL   ?DEALLOC_XSTACK8
    379            buf[tmpLen] = ' ';
   \   00003C   12....       LCALL   ?Subroutine1 & 0xFFFF
    380            err = (uint32)(value);
    381            _ltoa( err, &buf[tmpLen+1], format );
   \                     ??CrossCallReturnLabel_18:
   \   00003F                ; Setup parameters for call to function _ltoa
   \   00003F   A3           INC     DPTR
   \   000040   8582..       MOV     ?V0 + 2,DPL
   \   000043   8583..       MOV     ?V0 + 3,DPH
   \   000046   78..         MOV     R0,#?V0 + 2
   \   000048   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00004B   A9..         MOV     R1,?V0 + 0
   \   00004D   AA..         MOV     R2,?V0 + 8
   \   00004F   AB..         MOV     R3,?V0 + 9
   \   000051   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   000054   12....       LCALL   ?DEALLOC_XSTACK8
    382            HalLcdWriteString( (char*)buf, line );		
   \   000057                ; Setup parameters for call to function HalLcdWriteString
   \   000057   A9..         MOV     R1,?V0 + 1
   \   000059   85..82       MOV     DPL,?XSP + 0
   \   00005C   85..83       MOV     DPH,?XSP + 1
   \   00005F   AA82         MOV     R2,DPL
   \   000061   AB83         MOV     R3,DPH
   \   000063   12....       LCALL   ??HalLcdWriteString?relay
    383          #endif
    384          }
   \   000066   7419         MOV     A,#0x19
   \   000068   12....       LCALL   ?DEALLOC_XSTACK8
   \   00006B   7F0A         MOV     R7,#0xa
   \   00006D   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   E4           CLR     A
   \   000001                REQUIRE ??Subroutine6_0
   \   000001                ; // Fall through to label ??Subroutine6_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine6_0:
   \   000000   FC           MOV     R4,A
   \   000001   FD           MOV     R5,A
   \   000002                REQUIRE ??Subroutine7_0
   \   000002                ; // Fall through to label ??Subroutine7_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   AA82         MOV     R2,DPL
   \   000002   AB83         MOV     R3,DPH
   \   000004                REQUIRE ??Subroutine8_0
   \   000004                ; // Fall through to label ??Subroutine8_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   85..82       MOV     DPL,?XSP + 0
   \   000003   85..83       MOV     DPH,?XSP + 1
   \   000006   E582         MOV     A,DPL
   \   000008   25..         ADD     A,?V0 + 2
   \   00000A                REQUIRE ??Subroutine9_0
   \   00000A                ; // Fall through to label ??Subroutine9_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine9_0:
   \   000000   F582         MOV     DPL,A
   \   000002   E583         MOV     A,DPH
   \   000004                REQUIRE ??Subroutine10_0
   \   000004                ; // Fall through to label ??Subroutine10_0
    385          
    386          /**************************************************************************************************
    387           * @fn      HalLcdWriteStringValue
    388           *
    389           * @brief   Write a string followed by a value to the LCD
    390           *
    391           * @param   title   - Title that will be displayed before the value
    392           *          value1  - value #1
    393           *          format1 - redix of value #1
    394           *          value2  - value #2
    395           *          format2 - redix of value #2
    396           *          line    - line number
    397           *
    398           * @return  None
    399           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    400          void HalLcdWriteStringValueValue( char *title, uint16 value1, uint8 format1,
   \                     HalLcdWriteStringValueValue:
    401                                            uint16 value2, uint8 format2, uint8 line )
    402          {
   \   000000   74ED         MOV     A,#-0x13
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 19
   \   000005                ; Auto size: 25
   \   000005   74E7         MOV     A,#-0x19
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   \   00000E   8C..         MOV     ?V0 + 2,R4
   \   000010   8D..         MOV     ?V0 + 3,R5
   \   000012   89..         MOV     ?V0 + 5,R1
   \   000014   742C         MOV     A,#0x2c
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F5..         MOV     ?V0 + 0,A
   \   00001C   A3           INC     DPTR
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F5..         MOV     ?V0 + 1,A
   \   000020   742E         MOV     A,#0x2e
   \   000022   12....       LCALL   ?XSTACK_DISP0_8
   \   000025   E0           MOVX    A,@DPTR
   \   000026   F5..         MOV     ?V0 + 4,A
   \   000028   742F         MOV     A,#0x2f
   \   00002A   12....       LCALL   ?XSTACK_DISP0_8
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   F5..         MOV     ?V0 + 7,A
    403          
    404          #if (HAL_LCD == TRUE)
    405          
    406            uint8 tmpLen;
    407            uint8 buf[LCD_MAX_BUF];
    408            uint32 err;
    409          
    410            tmpLen = (uint8)osal_strlen( (char*)title );
   \   000030                ; Setup parameters for call to function osal_strlen
   \   000030   12....       LCALL   ??osal_strlen?relay
   \   000033   EA           MOV     A,R2
   \   000034   F5..         MOV     ?V0 + 6,A
    411            if ( tmpLen )
   \   000036   602C         JZ      ??HalLcdWriteStringValueValue_0
    412            {
    413              osal_memcpy( buf, title, tmpLen );
   \   000038                ; Setup parameters for call to function osal_memcpy
   \   000038   8E..         MOV     ?V0 + 8,R6
   \   00003A   8F..         MOV     ?V0 + 9,R7
   \   00003C   75..00       MOV     ?V0 + 10,#0x0
   \   00003F   78..         MOV     R0,#?V0 + 8
   \   000041   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000044   8A..         MOV     ?V0 + 8,R2
   \   000046   AC..         MOV     R4,?V0 + 8
   \   000048   7D00         MOV     R5,#0x0
   \   00004A   7403         MOV     A,#0x3
   \   00004C   12....       LCALL   ?XSTACK_DISP0_8
   \   00004F   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   000052   12....       LCALL   ?DEALLOC_XSTACK8
    414              buf[tmpLen++] = ' ';
   \   000055   85..82       MOV     DPL,?XSP + 0
   \   000058   85..83       MOV     DPH,?XSP + 1
   \   00005B   E582         MOV     A,DPL
   \   00005D   25..         ADD     A,?V0 + 8
   \   00005F   12....       LCALL   ??Subroutine9_0 & 0xFFFF
    415            }
   \                     ??CrossCallReturnLabel_17:
   \   000062   05..         INC     ?V0 + 6
    416          
    417            err = (uint32)(value1);
    418            _ltoa( err, &buf[tmpLen], format1 );
   \                     ??HalLcdWriteStringValueValue_0:
   \   000064                ; Setup parameters for call to function _ltoa
   \   000064   85....       MOV     ?V0 + 8,?V0 + 6
   \   000067   85..82       MOV     DPL,?XSP + 0
   \   00006A   85..83       MOV     DPH,?XSP + 1
   \   00006D   E582         MOV     A,DPL
   \   00006F   25..         ADD     A,?V0 + 8
   \   000071   F5..         MOV     ?V0 + 8,A
   \   000073   E583         MOV     A,DPH
   \   000075   3400         ADDC    A,#0x0
   \   000077   F5..         MOV     ?V0 + 9,A
   \   000079   78..         MOV     R0,#?V0 + 8
   \   00007B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00007E   A9..         MOV     R1,?V0 + 5
   \   000080   AA..         MOV     R2,?V0 + 2
   \   000082   AB..         MOV     R3,?V0 + 3
   \   000084   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   000087   12....       LCALL   ?DEALLOC_XSTACK8
    419            tmpLen = (uint8)osal_strlen( (char*)buf );
   \   00008A                ; Setup parameters for call to function osal_strlen
   \   00008A   85..82       MOV     DPL,?XSP + 0
   \   00008D   85..83       MOV     DPH,?XSP + 1
   \   000090   AA82         MOV     R2,DPL
   \   000092   AB83         MOV     R3,DPH
   \   000094   12....       LCALL   ??osal_strlen?relay
   \   000097   EA           MOV     A,R2
   \   000098   F5..         MOV     ?V0 + 6,A
    420          
    421            buf[tmpLen++] = ',';
   \   00009A   F5..         MOV     ?V0 + 2,A
   \   00009C   85..82       MOV     DPL,?XSP + 0
   \   00009F   85..83       MOV     DPH,?XSP + 1
   \   0000A2   E582         MOV     A,DPL
   \   0000A4   25..         ADD     A,?V0 + 2
   \   0000A6   F582         MOV     DPL,A
   \   0000A8   E583         MOV     A,DPH
   \   0000AA   3400         ADDC    A,#0x0
   \   0000AC   F583         MOV     DPH,A
   \   0000AE   742C         MOV     A,#0x2c
   \   0000B0   F0           MOVX    @DPTR,A
   \   0000B1   05..         INC     ?V0 + 6
    422            buf[tmpLen++] = ' ';
   \   0000B3   85....       MOV     ?V0 + 2,?V0 + 6
   \   0000B6   12....       LCALL   ?Subroutine1 & 0xFFFF
    423            err = (uint32)(value2);
    424            _ltoa( err, &buf[tmpLen], format2 );
   \                     ??CrossCallReturnLabel_19:
   \   0000B9                ; Setup parameters for call to function _ltoa
   \   0000B9   7401         MOV     A,#0x1
   \   0000BB   25..         ADD     A,?V0 + 6
   \   0000BD   F8           MOV     R0,A
   \   0000BE   85..82       MOV     DPL,?XSP + 0
   \   0000C1   85..83       MOV     DPH,?XSP + 1
   \   0000C4   E582         MOV     A,DPL
   \   0000C6   28           ADD     A,R0
   \   0000C7   F5..         MOV     ?V0 + 2,A
   \   0000C9   E583         MOV     A,DPH
   \   0000CB   3400         ADDC    A,#0x0
   \   0000CD   F5..         MOV     ?V0 + 3,A
   \   0000CF   78..         MOV     R0,#?V0 + 2
   \   0000D1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000D4   A9..         MOV     R1,?V0 + 4
   \   0000D6   AA..         MOV     R2,?V0 + 0
   \   0000D8   AB..         MOV     R3,?V0 + 1
   \   0000DA   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   0000DD   12....       LCALL   ?DEALLOC_XSTACK8
    425          
    426            HalLcdWriteString( (char *)buf, line );		
   \   0000E0                ; Setup parameters for call to function HalLcdWriteString
   \   0000E0   A9..         MOV     R1,?V0 + 7
   \   0000E2   85..82       MOV     DPL,?XSP + 0
   \   0000E5   85..83       MOV     DPH,?XSP + 1
   \   0000E8   AA82         MOV     R2,DPL
   \   0000EA   AB83         MOV     R3,DPH
   \   0000EC   12....       LCALL   ??HalLcdWriteString?relay
    427          
    428          #endif
    429          }
   \   0000EF   7419         MOV     A,#0x19
   \   0000F1   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000F4   7F0B         MOV     R7,#0xb
   \   0000F6   02....       LJMP    ?BANKED_LEAVE_XDATA
    430          
    431          /**************************************************************************************************
    432           * @fn      HalLcdDisplayPercentBar
    433           *
    434           * @brief   Display percentage bar on the LCD
    435           *
    436           * @param   title   -
    437           *          value   -
    438           *
    439           * @return  None
    440           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    441          void HalLcdDisplayPercentBar( char *title, uint8 value )
   \                     HalLcdDisplayPercentBar:
    442          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 17
   \   000005   74EF         MOV     A,#-0x11
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
    443          #if (HAL_LCD == TRUE)
    444          
    445            uint8 percent;
    446            uint8 leftOver;
    447            uint8 buf[17];
    448            uint32 err;
    449            uint8 x;
    450          
    451            /* Write the title: */
    452            HalLcdWriteString( title, HAL_LCD_LINE_1 );
   \   00000C                ; Setup parameters for call to function HalLcdWriteString
   \   00000C   7901         MOV     R1,#0x1
   \   00000E   12....       LCALL   ??HalLcdWriteString?relay
    453          
    454            if ( value > 100 )
   \   000011   EE           MOV     A,R6
   \   000012   C3           CLR     C
   \   000013   9465         SUBB    A,#0x65
   \   000015   4002         JC      ??HalLcdDisplayPercentBar_0
    455              value = 100;
   \   000017   7E64         MOV     R6,#0x64
    456          
    457            /* convert to blocks */
    458            percent = (uint8)(value / 10);
   \                     ??HalLcdDisplayPercentBar_0:
   \   000019   75F00A       MOV     B,#0xa
   \   00001C   EE           MOV     A,R6
   \   00001D   84           DIV     AB
   \   00001E   F5..         MOV     ?V0 + 3,A
    459            leftOver = (uint8)(value % 10);
   \   000020   EE           MOV     A,R6
   \   000021   75F00A       MOV     B,#0xa
   \   000024   84           DIV     AB
   \   000025   AFF0         MOV     R7,B
    460          
    461            /* Make window */
    462            osal_memcpy( buf, "[          ]  ", 15 );
   \   000027                ; Setup parameters for call to function osal_memcpy
   \   000027   75....       MOV     ?V0 + 0,#`?<Constant "[          ]  ">` & 0xff
   \   00002A   75....       MOV     ?V0 + 1,#(`?<Constant "[          ]  ">` >> 8) & 0xff
   \   00002D   75..00       MOV     ?V0 + 2,#0x0
   \   000030   78..         MOV     R0,#?V0 + 0
   \   000032   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000035   7C0F         MOV     R4,#0xf
   \   000037   7D00         MOV     R5,#0x0
   \   000039   7403         MOV     A,#0x3
   \   00003B   12....       LCALL   ?XSTACK_DISP0_8
   \   00003E   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   000041   12....       LCALL   ?DEALLOC_XSTACK8
    463          
    464            for ( x = 0; x < percent; x ++ )
   \   000044   E5..         MOV     A,?V0 + 3
   \   000046   601B         JZ      ??HalLcdDisplayPercentBar_1
    465            {
    466              buf[1+x] = '>';
   \   000048   F8           MOV     R0,A
   \   000049   7900         MOV     R1,#0x0
   \   00004B   7A3E         MOV     R2,#0x3e
   \   00004D   7401         MOV     A,#0x1
   \   00004F   12....       LCALL   ?XSTACK_DISP0_8
   \                     ??HalLcdDisplayPercentBar_2:
   \   000052   EA           MOV     A,R2
   \   000053   F0           MOVX    @DPTR,A
   \   000054   A3           INC     DPTR
   \   000055   E8           MOV     A,R0
   \   000056   24FF         ADD     A,#-0x1
   \   000058   18           DEC     R0
   \   000059   E9           MOV     A,R1
   \   00005A   34FF         ADDC    A,#-0x1
   \   00005C   F9           MOV     R1,A
   \   00005D   48           ORL     A,R0
   \   00005E   70F2         JNZ     ??HalLcdDisplayPercentBar_2
    467            }
   \   000060   85....       MOV     ?V0 + 2,?V0 + 3
    468          
    469            if ( leftOver >= 5 )
   \                     ??HalLcdDisplayPercentBar_1:
   \   000063   EF           MOV     A,R7
   \   000064   C3           CLR     C
   \   000065   9405         SUBB    A,#0x5
   \   000067   4019         JC      ??HalLcdDisplayPercentBar_3
    470              buf[1+x] = '+';
   \   000069   85....       MOV     ?V0 + 0,?V0 + 2
   \   00006C   85..82       MOV     DPL,?XSP + 0
   \   00006F   85..83       MOV     DPH,?XSP + 1
   \   000072   E582         MOV     A,DPL
   \   000074   25..         ADD     A,?V0 + 0
   \   000076   F582         MOV     DPL,A
   \   000078   E583         MOV     A,DPH
   \   00007A   3400         ADDC    A,#0x0
   \   00007C   F583         MOV     DPH,A
   \   00007E   A3           INC     DPTR
   \   00007F   742B         MOV     A,#0x2b
   \   000081   F0           MOVX    @DPTR,A
    471          
    472            err = (uint32)value;
    473            _ltoa( err, (uint8*)&buf[13], 10 );
   \                     ??HalLcdDisplayPercentBar_3:
   \   000082                ; Setup parameters for call to function _ltoa
   \   000082   740D         MOV     A,#0xd
   \   000084   12....       LCALL   ?XSTACK_DISP0_8
   \   000087   8582..       MOV     ?V0 + 0,DPL
   \   00008A   8583..       MOV     ?V0 + 1,DPH
   \   00008D   78..         MOV     R0,#?V0 + 0
   \   00008F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000092   790A         MOV     R1,#0xa
   \   000094   EE           MOV     A,R6
   \   000095   FA           MOV     R2,A
   \   000096   E4           CLR     A
   \   000097   FB           MOV     R3,A
   \   000098   12....       LCALL   ??Subroutine6_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_8:
   \   00009B   12....       LCALL   ?DEALLOC_XSTACK8
    474          
    475            HalLcdWriteString( (char*)buf, HAL_LCD_LINE_2 );
   \   00009E                ; Setup parameters for call to function HalLcdWriteString
   \   00009E   7902         MOV     R1,#0x2
   \   0000A0   85..82       MOV     DPL,?XSP + 0
   \   0000A3   85..83       MOV     DPH,?XSP + 1
   \   0000A6   AA82         MOV     R2,DPL
   \   0000A8   AB83         MOV     R3,DPH
   \   0000AA   12....       LCALL   ??HalLcdWriteString?relay
    476          
    477          #endif
    478          
    479          }
   \   0000AD   7411         MOV     A,#0x11
   \   0000AF   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000B2   7F04         MOV     R7,#0x4
   \   0000B4   02....       LJMP    ?BANKED_LEAVE_XDATA
    480          
    481          
    482          #if (HAL_LCD == TRUE)
    483          /**************************************************************************************************
    484           *                                    HARDWARE LCD
    485           **************************************************************************************************/
    486          
    487          /**************************************************************************************************
    488          
    489           * @fn      HalLcd_HW_Init
    490           *
    491           * @brief   Initilize HW LCD Driver.
    492           *
    493           * @param   None
    494           *
    495           * @return  None
    496           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    497          void HalLcd_HW_Init(void)
   \                     HalLcd_HW_Init:
    498          { 
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    499                  unsigned int i;
    500                  LCD_Init();
   \   000005                ; Setup parameters for call to function LCD_Init
   \   000005   12....       LCALL   ??LCD_Init?relay
    501                  //ÎïÁªÍø½ÌÑ§ÏµÍ³
    502                  //CVT-WSN-II
    503                  //Îäºº´´Î¬ÌØ¹«Ë¾
    504                  //cvtech.com.cn
    505          	SetBackLight(127);		//ÉèÖÃ±³¹âµÄÁÁ¶ÈµÈ¼¶Îª×îÁÁ127,0Îª×î°µ
   \   000008                ; Setup parameters for call to function SetBackLight
   \   000008   797F         MOV     R1,#0x7f
   \   00000A   12....       LCALL   ??SetBackLight?relay
    506          	ClrScreen();                
   \   00000D                ; Setup parameters for call to function ClrScreen
   \   00000D   12....       LCALL   ??ClrScreen?relay
    507                  FontSet_cn(1,1);                //16x16	
   \   000010                ; Setup parameters for call to function FontSet_cn
   \   000010   7A01         MOV     R2,#0x1
   \   000012   7901         MOV     R1,#0x1
   \   000014   12....       LCALL   ??FontSet_cn?relay
    508          	PutString_cn(8,0,"ÎïÁªÍø½ÌÑ§ÏµÍ³");	
   \   000017                ; Setup parameters for call to function PutString_cn
   \   000017   7C..         MOV     R4,#`?<Constant "\\316\\357\\301\\252\\315\\370\\275\\314\\3` & 0xff
   \   000019   7D..         MOV     R5,#(`?<Constant "\\316\\357\\301\\252\\315\\370\\275\\314\\3` >> 8) & 0xff
   \   00001B   7A00         MOV     R2,#0x0
   \   00001D   12....       LCALL   ?Subroutine4 & 0xFFFF
    509                  FontSet(1,1); 			  //Ñ¡ÔñASCII×Ö·û1(8X16),×Ö·ûÉ«Îª1(ºÚÉ«)
    510                  //PutString(24,16,"CVT-WSN-II");  //ÔÚÖ¸¶¨Î»ÖÃ¿ªÊ¼ÏÔÊ¾ASCII×Ö·û´®
    511                  //PutString(24,16,"CVT-WSN-III"); //ÔÚÖ¸¶¨Î»ÖÃ¿ªÊ¼ÏÔÊ¾ASCII×Ö·û´®
    512                  //PutString(24,16,"CVT-WSN-IV");  //ÔÚÖ¸¶¨Î»ÖÃ¿ªÊ¼ÏÔÊ¾ASCII×Ö·û´®        
    513                  //PutString(24,16,"CVT-WSN-V");	  //ÔÚÖ¸¶¨Î»ÖÃ¿ªÊ¼ÏÔÊ¾ASCII×Ö·û´®
    514                  PutString(24,16,"CVT-IOT-V");	  //ÔÚÖ¸¶¨Î»ÖÃ¿ªÊ¼ÏÔÊ¾ASCII×Ö·û´®
   \                     ??CrossCallReturnLabel_0:
   \   000020                ; Setup parameters for call to function PutString
   \   000020   7C..         MOV     R4,#`?<Constant "CVT-IOT-V">` & 0xff
   \   000022   7D..         MOV     R5,#(`?<Constant "CVT-IOT-V">` >> 8) & 0xff
   \   000024   7A10         MOV     R2,#0x10
   \   000026   7918         MOV     R1,#0x18
   \   000028   12....       LCALL   ??PutString?relay
    515                  FontSet_cn(1,1);                  //16x16
   \   00002B                ; Setup parameters for call to function FontSet_cn
   \   00002B   7A01         MOV     R2,#0x1
   \   00002D   7901         MOV     R1,#0x1
   \   00002F   12....       LCALL   ??FontSet_cn?relay
    516                  PutString_cn(8,32,"Îäºº´´Î¬ÌØ¹«Ë¾");	
   \   000032                ; Setup parameters for call to function PutString_cn
   \   000032   7C..         MOV     R4,#`?<Constant "\\316\\344\\272\\272\\264\\264\\316\\254\\3` & 0xff
   \   000034   7D..         MOV     R5,#(`?<Constant "\\316\\344\\272\\272\\264\\264\\316\\254\\3` >> 8) & 0xff
   \   000036   7A20         MOV     R2,#0x20
   \   000038   12....       LCALL   ?Subroutine4 & 0xFFFF
    517                  FontSet(1,1); 			//Ñ¡ÔñASCII×Ö·û1(8X16),×Ö·ûÉ«Îª1(ºÚÉ«)
    518                  PutString(12,48,"cvtech.com.cn");//ÔÚÖ¸¶¨Î»ÖÃ¿ªÊ¼ÏÔÊ¾ASCII×Ö·û´®
   \                     ??CrossCallReturnLabel_1:
   \   00003B                ; Setup parameters for call to function PutString
   \   00003B   7C..         MOV     R4,#`?<Constant "cvtech.com.cn">` & 0xff
   \   00003D   7D..         MOV     R5,#(`?<Constant "cvtech.com.cn">` >> 8) & 0xff
   \   00003F   7A30         MOV     R2,#0x30
   \   000041   790C         MOV     R1,#0xc
   \   000043   12....       LCALL   ??PutString?relay
    519                  for(i=0;i<30;i++){
   \   000046   7E1E         MOV     R6,#0x1e
    520                    TimeDelay(60000);
   \                     ??HalLcd_HW_Init_0:
   \   000048                ; Setup parameters for call to function TimeDelay
   \   000048   7A60         MOV     R2,#0x60
   \   00004A   7BEA         MOV     R3,#-0x16
   \   00004C   12....       LCALL   ??TimeDelay?relay
    521                  }
   \   00004F   1E           DEC     R6
   \   000050   EE           MOV     A,R6
   \   000051   70F5         JNZ     ??HalLcd_HW_Init_0
    522                  ClrScreen();
   \   000053                ; Setup parameters for call to function ClrScreen
   \   000053   12....       LCALL   ??ClrScreen?relay
    523          }
   \   000056   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   7908         MOV     R1,#0x8
   \   000002   12....       LCALL   ??PutString_cn?relay
   \   000005                ; Setup parameters for call to function FontSet
   \   000005                ; Setup parameters for call to function FontSet
   \   000005   7A01         MOV     R2,#0x1
   \   000007   7901         MOV     R1,#0x1
   \   000009   12....       LCALL   ??FontSet?relay
   \   00000C   22           RET
    524          
    525          /**************************************************************************************************
    526           * @fn          HalLcd_HW_SetContrast
    527           *
    528           * @brief       Set display contrast
    529           *
    530           * @param       uint8 value - contrast value
    531           *
    532           * @return      none
    533           **************************************************************************************************/
    534          /*void HalLcd_HW_SetContrast(uint8 value)
    535          {
    536            SET_ICONRAM_ADDR(CONTRAST_CTRL_REGISTER);
    537            HalLcd_HW_Write(value);
    538          }*/
    539          
    540          /**************************************************************************************************
    541           * @fn      HalLcd_HW_Clear
    542           *
    543           * @brief   Clear the HW LCD
    544           *
    545           * @param   None
    546           *
    547           * @return  None
    548           **************************************************************************************************/
    549          /*void HalLcd_HW_Clear(void)
    550          {
    551            uint8 n;
    552          
    553            SET_DDRAM_ADDR(0x00);
    554            for (n = 0; n < (LCD_MAX_LINE_COUNT * LCD_MAX_LINE_LENGTH); n++)
    555            {
    556              HalLcd_HW_Write(' ');
    557            }
    558          }*/
    559          
    560          /**************************************************************************************************
    561           * @fn      HalLcd_HW_ClearAllSpecChars
    562           *
    563           * @brief   Clear all special chars
    564           *
    565           * @param   None
    566           *
    567           * @return  None
    568           **************************************************************************************************/
    569          /*void HalLcd_HW_ClearAllSpecChars(void)
    570          {
    571            uint8 n = 0;
    572          
    573            SET_GCRAM_CHAR(0);
    574            for (n = 0; n < (8 * 8); n++)
    575            {
    576              HalLcd_HW_Write(0x00);
    577            }
    578          }*/
    579          
    580          /**************************************************************************************************
    581           * @fn      HalLcd_HW_WriteChar
    582           *
    583           * @brief   Write one char to the display
    584           *
    585           * @param   uint8 line - line number that the char will be displayed
    586           *          uint8 col - colum where the char will be displayed
    587           *
    588           * @return  None
    589           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    590          void HalLcd_HW_WriteChar(uint8 line, uint8 col, char text)
   \                     HalLcd_HW_WriteChar:
    591          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FF           MOV     R7,A
   \   000007   8A..         MOV     ?V0 + 0,R2
    592            if (col < LCD_MAX_LINE_LENGTH)
   \   000009   EA           MOV     A,R2
   \   00000A   C3           CLR     C
   \   00000B   9410         SUBB    A,#0x10
   \   00000D   5012         JNC     ??HalLcd_HW_WriteChar_0
    593            {
    594              PutChar(col*8,(line - 1)*16,text) ;     
   \   00000F                ; Setup parameters for call to function PutChar
   \   00000F   74FF         MOV     A,#-0x1
   \   000011   2F           ADD     A,R7
   \   000012   C4           SWAP    A
   \   000013   54F0         ANL     A,#0xf0
   \   000015   FA           MOV     R2,A
   \   000016   E5..         MOV     A,?V0 + 0
   \   000018   33           RLC     A
   \   000019   33           RLC     A
   \   00001A   33           RLC     A
   \   00001B   54F8         ANL     A,#0xf8
   \   00001D   F9           MOV     R1,A
   \   00001E   12....       LCALL   ??PutChar?relay
    595            }
    596            else
    597            {
    598              return;
    599            }
    600          }
   \                     ??HalLcd_HW_WriteChar_0:
   \   000021   02....       LJMP    ?Subroutine0 & 0xFFFF
    601          
    602          /**************************************************************************************************
    603           * @fn          halLcdWriteLine
    604           *
    605           * @brief       Write one line on display
    606           *
    607           * @param       uint8 line - display line
    608           *              char *pText - text buffer to write
    609           *
    610           * @return      none
    611           **************************************************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    612          void HalLcd_HW_WriteLine(uint8 line, const char *pText)
   \                     HalLcd_HW_WriteLine:
    613          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 1,R1
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
   \   000009   EB           MOV     A,R3
   \   00000A   FF           MOV     R7,A
    614            uint8 count;
    615            uint8 totalLength = (uint8)osal_strlen( (char *)pText );
   \   00000B                ; Setup parameters for call to function osal_strlen
   \   00000B   12....       LCALL   ?Subroutine5 & 0xFFFF
    616          
    617            /* Write the content first */
    618            for (count=0; count<totalLength; count++)
   \                     ??CrossCallReturnLabel_4:
   \   00000E   75..00       MOV     ?V0 + 0,#0x0
   \   000011   8018         SJMP    ??HalLcd_HW_WriteLine_0
    619            {
    620              HalLcd_HW_WriteChar(line, count, (*(pText++)));
   \                     ??HalLcd_HW_WriteLine_1:
   \   000013                ; Setup parameters for call to function HalLcd_HW_WriteChar
   \   000013   8E82         MOV     DPL,R6
   \   000015   8F83         MOV     DPH,R7
   \   000017   E0           MOVX    A,@DPTR
   \   000018   FB           MOV     R3,A
   \   000019   AA..         MOV     R2,?V0 + 0
   \   00001B   A9..         MOV     R1,?V0 + 1
   \   00001D   12....       LCALL   ??HalLcd_HW_WriteChar?relay
   \   000020   8E82         MOV     DPL,R6
   \   000022   8F83         MOV     DPH,R7
   \   000024   A3           INC     DPTR
   \   000025   AE82         MOV     R6,DPL
   \   000027   AF83         MOV     R7,DPH
    621            }
   \   000029   05..         INC     ?V0 + 0
   \                     ??HalLcd_HW_WriteLine_0:
   \   00002B   E5..         MOV     A,?V0 + 0
   \   00002D   C3           CLR     C
   \   00002E   95..         SUBB    A,?V0 + 2
   \   000030   40E1         JC      ??HalLcd_HW_WriteLine_1
    622          
    623            // Write blank spaces to rest of the line 
    624            for(count=totalLength; count<LCD_MAX_LINE_LENGTH;count++)
   \   000032   85....       MOV     ?V0 + 0,?V0 + 2
   \   000035   800B         SJMP    ??HalLcd_HW_WriteLine_2
    625            {
    626              HalLcd_HW_WriteChar(line, count, ' ');
   \                     ??HalLcd_HW_WriteLine_3:
   \   000037                ; Setup parameters for call to function HalLcd_HW_WriteChar
   \   000037   7B20         MOV     R3,#0x20
   \   000039   AA..         MOV     R2,?V0 + 0
   \   00003B   A9..         MOV     R1,?V0 + 1
   \   00003D   12....       LCALL   ??HalLcd_HW_WriteChar?relay
    627            }
   \   000040   05..         INC     ?V0 + 0
   \                     ??HalLcd_HW_WriteLine_2:
   \   000042   E5..         MOV     A,?V0 + 0
   \   000044   C3           CLR     C
   \   000045   9410         SUBB    A,#0x10
   \   000047   40EE         JC      ??HalLcd_HW_WriteLine_3
    628          }
   \   000049   7F03         MOV     R7,#0x3
   \   00004B   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdInit?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdInit

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteString?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteString

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteValue?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteValue

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteScreen?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteScreen

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteStringValue?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteStringValue

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdWriteStringValueValue?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdWriteStringValueValue

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcdDisplayPercentBar?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcdDisplayPercentBar

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_WriteChar?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_WriteChar

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalLcd_HW_WriteLine?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalLcd_HW_WriteLine

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "[          ]  ">`:
   \   000000   5B202020     DB "[          ]  "
   \            20202020
   \            2020205D
   \            202000  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "\\316\\357\\301\\252\\315\\370\\275\\314\\3`:
   \   000000   CEEFC1AA     DB "\316\357\301\252\315\370\275\314\321\247\317\265\315\263"
   \            CDF8BDCC
   \            D1A7CFB5
   \            CDB300  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "CVT-IOT-V">`:
   \   000000   4356542D     DB "CVT-IOT-V"
   \            494F542D
   \            5600    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "\\316\\344\\272\\272\\264\\264\\316\\254\\3`:
   \   000000   CEE4BABA     DB "\316\344\272\272\264\264\316\254\314\330\271\253\313\276"
   \            B4B4CEAC
   \            CCD8B9AB
   \            CBBE00  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "cvtech.com.cn">`:
   \   000000   63767465     DB "cvtech.com.cn"
   \            63682E63
   \            6F6D2E63
   \            6E00    
    629          
    630          /**************************************************************************************************
    631           * @fn      HalLcd_HW_WaitUs
    632           *
    633           * @brief   wait for x us. @ 32MHz MCU clock it takes 32 "nop"s for 1 us delay.
    634           *
    635           * @param   x us. range[0-65536]
    636           *
    637           * @return  None
    638           **************************************************************************************************/
    639          /*void HalLcd_HW_WaitUs(uint16 microSecs)
    640          {
    641            while(microSecs--)
    642            {
    643              // 32 NOPs == 1 usecs
    644              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    645              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    646              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    647              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    648              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    649              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    650              asm("nop"); asm("nop");
    651            }
    652          }*/
    653          #endif
    654          
    655          
    656          /**************************************************************************************************
    657          **************************************************************************************************/
    658          
    659          
    660          

   Maximum stack usage in bytes:

     Function                    ISTACK PSTACK XSTACK
     --------                    ------ ------ ------
     HalLcdDisplayPercentBar         0      0     32
       -> HalLcdWriteString          0      0     58
       -> osal_memcpy                0      0     64
       -> _ltoa                      0      0     62
       -> HalLcdWriteString          0      0     58
     HalLcdInit                      2      0      0
       -> HalLcd_HW_Init             4      0      0
     HalLcdWriteScreen               0      0      9
       -> HalLcdWriteString          0      0     18
       -> HalLcdWriteString          0      0     18
     HalLcdWriteString               0      0     64
       -> osal_strlen                0      0     34
       -> osal_memcpy                0      0     40
       -> osal_strlen                0      0     34
       -> osal_mem_alloc             0      0     34
       -> osal_memcpy                0      0     40
       -> osal_memcpy                0      0     40
       -> debug_str                  0      0     34
       -> osal_mem_free              0      0     34
       -> HalLcd_HW_WriteLine        0      0     34
     HalLcdWriteStringValue          0      0     47
       -> osal_strlen                0      0     86
       -> osal_memcpy                0      0     92
       -> _ltoa                      0      0     90
       -> HalLcdWriteString          0      0     86
     HalLcdWriteStringValueValue     0      0     51
       -> osal_strlen                0      0     88
       -> osal_memcpy                0      0     94
       -> _ltoa                      0      0     92
       -> osal_strlen                0      0     88
       -> _ltoa                      0      0     92
       -> HalLcdWriteString          0      0     88
     HalLcdWriteValue                0      0     44
       -> _ltoa                      0      0     86
       -> HalLcdWriteString          0      0     82
     HalLcd_HW_Init                  0      0      9
       -> LCD_Init                   0      0     18
       -> SetBackLight               0      0     18
       -> ClrScreen                  0      0     18
       -> FontSet_cn                 0      0     18
       -> PutString_cn               0      0     18
       -> FontSet                    0      0     18
       -> PutString                  0      0     18
       -> FontSet_cn                 0      0     18
       -> PutString_cn               0      0     18
       -> FontSet                    0      0     18
       -> PutString                  0      0     18
       -> TimeDelay                  0      0     18
       -> ClrScreen                  0      0     18
     HalLcd_HW_WriteChar             0      0     20
       -> PutChar                    0      0     18
     HalLcd_HW_WriteLine             0      0     28
       -> osal_strlen                0      0     22
       -> HalLcd_HW_WriteChar        0      0     22
       -> HalLcd_HW_WriteChar        0      0     22


   Segment part sizes:

     Function/Label                                 Bytes
     --------------                                 -----
     Lcd_Line1                                         2
     HalLcdInit                                       21
     HalLcdWriteString                               241
     ?Subroutine5                                      7
     ??Subroutine8_0                                   6
     ??Subroutine10_0                                  8
     HalLcdWriteValue                                 65
     ??Subroutine7_0                                   6
     HalLcdWriteScreen                                23
     ?Subroutine0                                      5
     HalLcdWriteStringValue                          112
     ?Subroutine3                                      1
     ??Subroutine6_0                                   2
     ?Subroutine2                                      4
     ?Subroutine1                                     10
     ??Subroutine9_0                                   4
     HalLcdWriteStringValueValue                     249
     HalLcdDisplayPercentBar                         183
     HalLcd_HW_Init                                   89
     ?Subroutine4                                     13
     HalLcd_HW_WriteChar                              36
     HalLcd_HW_WriteLine                              78
     ??HalLcdInit?relay                                6
     ??HalLcdWriteString?relay                         6
     ??HalLcdWriteValue?relay                          6
     ??HalLcdWriteScreen?relay                         6
     ??HalLcdWriteStringValue?relay                    6
     ??HalLcdWriteStringValueValue?relay               6
     ??HalLcdDisplayPercentBar?relay                   6
     ??HalLcd_HW_Init?relay                            6
     ??HalLcd_HW_WriteChar?relay                       6
     ??HalLcd_HW_WriteLine?relay                       6
     ?<Constant "[          ]  ">                     15
     ?<Constant "\316\357\301\252\315\370\275\314\3   15
     ?<Constant "CVT-IOT-V">                          10
     ?<Constant "\316\344\272\272\264\264\316\254\3   15
     ?<Constant "cvtech.com.cn">                      14

 
 1 163 bytes in segment BANKED_CODE
    60 bytes in segment BANK_RELAYS
    69 bytes in segment XDATA_ROM_C
     2 bytes in segment XDATA_Z
 
 1 223 bytes of CODE  memory
    69 bytes of CONST memory
     2 bytes of XDATA memory

Errors: none
Warnings: none
